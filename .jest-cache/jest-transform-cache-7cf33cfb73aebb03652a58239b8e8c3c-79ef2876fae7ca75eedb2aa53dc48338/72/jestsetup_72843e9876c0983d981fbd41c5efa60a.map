{"file":"C:\\Users\\ojoseph\\Documents\\StrellerMinds-Backend\\test\\setup\\jest.setup.ts","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsBA,oCAAoC;AACpC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,GAAG,EAAE,CAAC,CAAC;IAC7B,eAAe,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;QAC9B,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,iBAAiB,CAAC,EAAE,SAAS,EAAE,iBAAiB,EAAE,CAAC;QACvE,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC;KAC1C,CAAC,CAAC;CACJ,CAAC,CAAC,CAAC;AAEJ,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE,GAAG,EAAE,CAAC,CAAC;IACrC,QAAQ,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;QACvB,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;KAChB,CAAC,CAAC;IACH,gBAAgB,EAAE,IAAI,CAAC,EAAE,EAAE;IAC3B,gBAAgB,EAAE,IAAI,CAAC,EAAE,EAAE;IAC3B,mBAAmB,EAAE,IAAI,CAAC,EAAE,EAAE;IAC9B,iBAAiB,EAAE,IAAI,CAAC,EAAE,EAAE;CAC7B,CAAC,CAAC,CAAC;AAEJ,IAAI,CAAC,IAAI,CAAC,4BAA4B,EAAE,GAAG,EAAE,CAAC,CAAC;IAC7C,gBAAgB,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;QAC/B,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;KAChB,CAAC,CAAC;IACH,yBAAyB,EAAE,IAAI,CAAC,EAAE,EAAE;IACpC,sBAAsB,EAAE,IAAI,CAAC,EAAE,EAAE;CAClC,CAAC,CAAC,CAAC;AAEJ,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,EAAE,CAAC,CAAC;IACzB,UAAU,EAAE,IAAI;IAChB,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;QACtB,SAAS,EAAE;YACT,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE;YACnB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,GAAG,EAAE,IAAI,CAAC,EAAE,EAAE;SACf;QACD,cAAc,EAAE;YACd,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE;YACnB,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE;YAClB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;SAClB;QACD,aAAa,EAAE;YACb,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE;YACnB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,GAAG,EAAE,IAAI,CAAC,EAAE,EAAE;SACf;QACD,QAAQ,EAAE;YACR,cAAc,EAAE,IAAI,CAAC,EAAE,EAAE;SAC1B;KACF,CAAC,CAAC;CACJ,CAAC,CAAC,CAAC;AAzEJ,4BAA0B;AAC1B,mCAAgC;AAIhC,kCAAkC;AAClC,IAAA,eAAM,EAAC,EAAE,IAAI,EAAE,WAAW,EAAE,CAAC,CAAC;AAE9B,4BAA4B;AAC5B,MAAM,CAAC,OAAO,GAAG;IACf,GAAG,OAAO;IACV,yDAAyD;IACzD,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,YAAY,KAAK,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE;IAClE,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,YAAY,KAAK,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE;IACtE,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,YAAY,KAAK,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE;IACpE,IAAI,EAAE,OAAO,CAAC,IAAI;IAClB,KAAK,EAAE,OAAO,CAAC,KAAK;CACrB,CAAC;AAEF,sBAAsB;AACtB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;AAuDvB,kCAAkC;AAClC,IAAI,cAA0B,CAAC;AAE/B,2BAA2B;AAC3B,SAAS,CAAC,KAAK,IAAI,EAAE;IACnB,gDAAgD;IAChD,IAAI,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;QAC7B,+BAA+B;IACjC,CAAC;AACH,CAAC,CAAC,CAAC;AAEH,QAAQ,CAAC,KAAK,IAAI,EAAE;IAClB,mCAAmC;IACnC,IAAI,cAAc,IAAI,cAAc,CAAC,aAAa,EAAE,CAAC;QACnD,MAAM,cAAc,CAAC,OAAO,EAAE,CAAC;IACjC,CAAC;AACH,CAAC,CAAC,CAAC;AAEH,UAAU,CAAC,GAAG,EAAE;IACd,mCAAmC;IACnC,IAAI,CAAC,aAAa,EAAE,CAAC;AACvB,CAAC,CAAC,CAAC;AAEH,SAAS,CAAC,GAAG,EAAE;IACb,qCAAqC;IACrC,IAAI,CAAC,eAAe,EAAE,CAAC;AACzB,CAAC,CAAC,CAAC;AAuBH,wBAAwB;AACxB,MAAM,CAAC,SAAS,GAAG;IACjB,mBAAmB,EAAE,KAAK,EAAE,QAAa,EAA0B,EAAE;QACnE,MAAM,EAAE,IAAI,EAAE,GAAG,wDAAa,iBAAiB,GAAC,CAAC;QACjD,OAAO,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC,OAAO,EAAE,CAAC;IACtD,CAAC;IAED,oBAAoB,EAAE,GAAG,EAAE,CAAC,CAAC;QAC3B,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;QACf,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE;QAClB,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;QACpB,YAAY,EAAE,IAAI,CAAC,EAAE,EAAE;QACvB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;QACjB,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;QACf,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;QACjB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;QACjB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;QACjB,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE;QAChB,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;QACpB,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;QACpB,kBAAkB,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;YACjC,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACjC,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACpC,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACnC,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACnC,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACjC,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YAClC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YAChC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YAChC,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACpC,iBAAiB,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YAC7C,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACrC,kBAAkB,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YAC9C,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YAClC,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACrC,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YACnC,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE;YAClC,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE;YAClB,eAAe,EAAE,IAAI,CAAC,EAAE,EAAE;YAC1B,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE;YACnB,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;YACpB,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE;YACrB,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE;SACnB,CAAC,CAAC;KACJ,CAAC;IAEF,iBAAiB,EAAE,CAAC,OAAiB,EAAE,EAAE;QACvC,MAAM,WAAW,GAAG,EAAE,CAAC;QACvB,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YACvB,WAAW,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;QAClC,CAAC,CAAC,CAAC;QACH,OAAO,WAAW,CAAC;IACrB,CAAC;IAED,gBAAgB,EAAE,CAAC,IAAY,EAAE,YAAiB,EAAE,EAAE,EAAE;QACtD,0CAA0C;QAC1C,OAAO,EAAE,GAAG,SAAS,EAAE,CAAC;IAC1B,CAAC;IAED,eAAe,EAAE,KAAK,IAAI,EAAE;QAC1B,kCAAkC;QAClC,IAAI,cAAc,IAAI,cAAc,CAAC,aAAa,EAAE,CAAC;YACnD,qBAAqB;QACvB,CAAC;IACH,CAAC;CACF,CAAC;AAEF,yBAAyB;AACzB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;IAC1B,OAAO,CAAC,GAAG,CAAC,QAAQ,GAAG,MAAM,CAAC;AAChC,CAAC;AAED,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,MAAM,EAAE,CAAC;IACpC,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;AAC1D,CAAC","names":[],"sources":["C:\\Users\\ojoseph\\Documents\\StrellerMinds-Backend\\test\\setup\\jest.setup.ts"],"sourcesContent":["import 'reflect-metadata';\r\nimport { config } from 'dotenv';\r\nimport { DataSource } from 'typeorm';\r\nimport { TestingModule } from '@nestjs/testing';\r\n\r\n// Load test environment variables\r\nconfig({ path: '.env.test' });\r\n\r\n// Global test configuration\r\nglobal.console = {\r\n  ...console,\r\n  // Suppress console.log in tests unless explicitly needed\r\n  log: process.env.JEST_VERBOSE === 'true' ? console.log : jest.fn(),\r\n  debug: process.env.JEST_VERBOSE === 'true' ? console.debug : jest.fn(),\r\n  info: process.env.JEST_VERBOSE === 'true' ? console.info : jest.fn(),\r\n  warn: console.warn,\r\n  error: console.error,\r\n};\r\n\r\n// Global test timeout\r\njest.setTimeout(30000);\r\n\r\n// Mock external services by default\r\njest.mock('nodemailer', () => ({\r\n  createTransport: jest.fn(() => ({\r\n    sendMail: jest.fn().mockResolvedValue({ messageId: 'test-message-id' }),\r\n    verify: jest.fn().mockResolvedValue(true),\r\n  })),\r\n}));\r\n\r\njest.mock('@aws-sdk/client-s3', () => ({\r\n  S3Client: jest.fn(() => ({\r\n    send: jest.fn(),\r\n  })),\r\n  PutObjectCommand: jest.fn(),\r\n  GetObjectCommand: jest.fn(),\r\n  DeleteObjectCommand: jest.fn(),\r\n  HeadObjectCommand: jest.fn(),\r\n}));\r\n\r\njest.mock('@aws-sdk/client-cloudfront', () => ({\r\n  CloudFrontClient: jest.fn(() => ({\r\n    send: jest.fn(),\r\n  })),\r\n  CreateInvalidationCommand: jest.fn(),\r\n  GetDistributionCommand: jest.fn(),\r\n}));\r\n\r\njest.mock('stripe', () => ({\r\n  __esModule: true,\r\n  default: jest.fn(() => ({\r\n    customers: {\r\n      create: jest.fn(),\r\n      retrieve: jest.fn(),\r\n      update: jest.fn(),\r\n      del: jest.fn(),\r\n    },\r\n    paymentIntents: {\r\n      create: jest.fn(),\r\n      retrieve: jest.fn(),\r\n      confirm: jest.fn(),\r\n      cancel: jest.fn(),\r\n    },\r\n    subscriptions: {\r\n      create: jest.fn(),\r\n      retrieve: jest.fn(),\r\n      update: jest.fn(),\r\n      del: jest.fn(),\r\n    },\r\n    webhooks: {\r\n      constructEvent: jest.fn(),\r\n    },\r\n  })),\r\n}));\r\n\r\n// Global test database connection\r\nlet testDataSource: DataSource;\r\n\r\n// Setup and teardown hooks\r\nbeforeAll(async () => {\r\n  // Initialize test database connection if needed\r\n  if (process.env.DATABASE_URL) {\r\n    // Database setup would go here\r\n  }\r\n});\r\n\r\nafterAll(async () => {\r\n  // Cleanup test database connection\r\n  if (testDataSource && testDataSource.isInitialized) {\r\n    await testDataSource.destroy();\r\n  }\r\n});\r\n\r\nbeforeEach(() => {\r\n  // Clear all mocks before each test\r\n  jest.clearAllMocks();\r\n});\r\n\r\nafterEach(() => {\r\n  // Additional cleanup after each test\r\n  jest.restoreAllMocks();\r\n});\r\n\r\n// Global test utilities\r\ndeclare global {\r\n  namespace jest {\r\n    interface Matchers<R> {\r\n      toBeValidUUID(): R;\r\n      toBeValidEmail(): R;\r\n      toBeValidDate(): R;\r\n      toHaveValidationError(field: string): R;\r\n      toMatchApiResponse(): R;\r\n    }\r\n  }\r\n  \r\n  var testUtils: {\r\n    createTestingModule: (metadata: any) => Promise<TestingModule>;\r\n    createMockRepository: () => any;\r\n    createMockService: (methods: string[]) => any;\r\n    generateTestData: (type: string, overrides?: any) => any;\r\n    cleanupDatabase: () => Promise<void>;\r\n  };\r\n}\r\n\r\n// Export test utilities\r\nglobal.testUtils = {\r\n  createTestingModule: async (metadata: any): Promise<TestingModule> => {\r\n    const { Test } = await import('@nestjs/testing');\r\n    return Test.createTestingModule(metadata).compile();\r\n  },\r\n\r\n  createMockRepository: () => ({\r\n    find: jest.fn(),\r\n    findOne: jest.fn(),\r\n    findOneBy: jest.fn(),\r\n    findAndCount: jest.fn(),\r\n    create: jest.fn(),\r\n    save: jest.fn(),\r\n    update: jest.fn(),\r\n    delete: jest.fn(),\r\n    remove: jest.fn(),\r\n    count: jest.fn(),\r\n    increment: jest.fn(),\r\n    decrement: jest.fn(),\r\n    createQueryBuilder: jest.fn(() => ({\r\n      where: jest.fn().mockReturnThis(),\r\n      andWhere: jest.fn().mockReturnThis(),\r\n      orWhere: jest.fn().mockReturnThis(),\r\n      orderBy: jest.fn().mockReturnThis(),\r\n      limit: jest.fn().mockReturnThis(),\r\n      offset: jest.fn().mockReturnThis(),\r\n      skip: jest.fn().mockReturnThis(),\r\n      take: jest.fn().mockReturnThis(),\r\n      leftJoin: jest.fn().mockReturnThis(),\r\n      leftJoinAndSelect: jest.fn().mockReturnThis(),\r\n      innerJoin: jest.fn().mockReturnThis(),\r\n      innerJoinAndSelect: jest.fn().mockReturnThis(),\r\n      select: jest.fn().mockReturnThis(),\r\n      addSelect: jest.fn().mockReturnThis(),\r\n      groupBy: jest.fn().mockReturnThis(),\r\n      having: jest.fn().mockReturnThis(),\r\n      getOne: jest.fn(),\r\n      getMany: jest.fn(),\r\n      getManyAndCount: jest.fn(),\r\n      getCount: jest.fn(),\r\n      getRawOne: jest.fn(),\r\n      getRawMany: jest.fn(),\r\n      execute: jest.fn(),\r\n    })),\r\n  }),\r\n\r\n  createMockService: (methods: string[]) => {\r\n    const mockService = {};\r\n    methods.forEach(method => {\r\n      mockService[method] = jest.fn();\r\n    });\r\n    return mockService;\r\n  },\r\n\r\n  generateTestData: (type: string, overrides: any = {}) => {\r\n    // This will be implemented with factories\r\n    return { ...overrides };\r\n  },\r\n\r\n  cleanupDatabase: async () => {\r\n    // Database cleanup implementation\r\n    if (testDataSource && testDataSource.isInitialized) {\r\n      // Clean up test data\r\n    }\r\n  },\r\n};\r\n\r\n// Environment validation\r\nif (!process.env.NODE_ENV) {\r\n  process.env.NODE_ENV = 'test';\r\n}\r\n\r\nif (process.env.NODE_ENV !== 'test') {\r\n  throw new Error('Tests must be run with NODE_ENV=test');\r\n}\r\n"],"version":3}