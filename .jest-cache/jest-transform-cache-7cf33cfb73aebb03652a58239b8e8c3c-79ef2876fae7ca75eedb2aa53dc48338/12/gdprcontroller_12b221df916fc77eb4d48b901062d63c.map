{"file":"C:\\Users\\ojoseph\\Documents\\StrellerMinds-Backend\\src\\gdpr\\gdpr.controller.ts","mappings":"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","names":[],"sources":["C:\\Users\\ojoseph\\Documents\\StrellerMinds-Backend\\src\\gdpr\\gdpr.controller.ts"],"sourcesContent":["/**\r\n * GdprController handles endpoints for user consent, data export, and deletion requests.\r\n */\r\nimport {\r\n  Controller,\r\n  Get,\r\n  Post,\r\n  Put,\r\n  Body,\r\n  Param,\r\n  Req,\r\n  Res,\r\n  HttpCode,\r\n  HttpStatus,\r\n} from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiResponse, ApiParam, ApiBody } from '@nestjs/swagger';\r\nimport { Request, Response } from 'express';\r\nimport { GdprService } from './gdpr.service';\r\nimport { UpdateConsentDto, ConsentPreferencesDto } from './dto/consent.dto';\r\nimport { DataExportRequestDto } from './dto/data-export.dto';\r\nimport { CreateDeletionRequestDto } from './dto/deletion-request.dto';\r\n\r\n@ApiTags('GDPR')\r\n@Controller('gdpr')\r\nexport class GdprController {\r\n  constructor(private gdprService: GdprService) {}\r\n\r\n  // ==================== CONSENT ENDPOINTS ====================\r\n  /**\r\n   * Get user consents by user ID.\r\n   */\r\n  @Get('consents/:userId')\r\n  @ApiOperation({ summary: 'Get user consents' })\r\n  @ApiParam({ name: 'userId', description: 'User ID' })\r\n  @ApiResponse({ status: 200, description: 'User consents retrieved' })\r\n  async getUserConsents(@Param('userId') userId: string) {\r\n    return this.gdprService.getConsentService().getUserConsents(userId);\r\n  }\r\n\r\n  /**\r\n   * Update user consent by user ID.\r\n   */\r\n  @Put('consents/:userId')\r\n  @ApiOperation({ summary: 'Update user consent' })\r\n  @ApiParam({ name: 'userId', description: 'User ID' })\r\n  @ApiBody({ type: UpdateConsentDto })\r\n  @ApiResponse({ status: 200, description: 'User consent updated' })\r\n  async updateConsent(\r\n    @Param('userId') userId: string,\r\n    @Body() updateConsentDto: UpdateConsentDto,\r\n  ) {\r\n    return this.gdprService\r\n      .getConsentService()\r\n      .updateConsent(userId, updateConsentDto);\r\n  }\r\n\r\n  /**\r\n   * Update user consent preferences by user ID.\r\n   */\r\n  @Put('consents/:userId/preferences')\r\n  @ApiOperation({ summary: 'Update user consent preferences' })\r\n  @ApiParam({ name: 'userId', description: 'User ID' })\r\n  @ApiBody({ type: ConsentPreferencesDto })\r\n  @ApiResponse({ status: 200, description: 'User consent preferences updated' })\r\n  async updateConsentPreferences(\r\n    @Param('userId') userId: string,\r\n    @Body() preferences: ConsentPreferencesDto,\r\n  ) {\r\n    return this.gdprService\r\n      .getConsentService()\r\n      .updateConsentPreferences(userId, preferences);\r\n  }\r\n\r\n  /**\r\n   * Withdraw all consents for a user.\r\n   */\r\n  @Post('consents/:userId/withdraw-all')\r\n  @HttpCode(HttpStatus.NO_CONTENT)\r\n  @ApiOperation({ summary: 'Withdraw all consents' })\r\n  @ApiParam({ name: 'userId', description: 'User ID' })\r\n  @ApiResponse({ status: 204, description: 'All consents withdrawn' })\r\n  async withdrawAllConsents(@Param('userId') userId: string) {\r\n    await this.gdprService.getConsentService().withdrawAllConsents(userId);\r\n  }\r\n\r\n  // ==================== DATA EXPORT ENDPOINTS ====================\r\n  /**\r\n   * Request data export for a user.\r\n   */\r\n  @Post('export/:userId')\r\n  @ApiOperation({ summary: 'Request data export' })\r\n  @ApiParam({ name: 'userId', description: 'User ID' })\r\n  @ApiBody({ type: DataExportRequestDto })\r\n  @ApiResponse({ status: 200, description: 'Data export requested' })\r\n  async exportUserData(\r\n    @Param('userId') userId: string,\r\n    @Body() dataExportRequestDto: DataExportRequestDto,\r\n  ) {\r\n    return this.gdprService.getDataExportService().exportUserData(userId, dataExportRequestDto);\r\n  }\r\n\r\n  // ==================== DELETION REQUEST ENDPOINTS ====================\r\n  /**\r\n   * Create a deletion request for a user.\r\n   */\r\n  @Post('deletion/:userId')\r\n  @ApiOperation({ summary: 'Create deletion request' })\r\n  @ApiParam({ name: 'userId', description: 'User ID' })\r\n  @ApiBody({ type: CreateDeletionRequestDto })\r\n  @ApiResponse({ status: 201, description: 'Deletion request created' })\r\n  async createDeletionRequest(\r\n    @Param('userId') userId: string,\r\n    @Body() createDeletionRequestDto: CreateDeletionRequestDto,\r\n  ) {\r\n    return this.gdprService.getDataDeletionService().createDeletionRequest(userId, createDeletionRequestDto);\r\n  }\r\n}\r\n"],"version":3}